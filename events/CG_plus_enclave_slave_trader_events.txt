namespace = cg_plus_enclave_slaver


# event_target:


# npc country   event_target:cg_plus_slaver_country
# 0000 diplo gate
# 0999 1st esta
# 01xx diplo events
# 1900 check slave full
# 3xxx 
# 5xxx capture leaders events
# 7xxx train events
# 8xxx buy regular slave process
# 8600 sell slaves on regular

# 9xxx ruler auctions


country_event = {
	id= cg_plus_enclave_slaver.0000
	hide_window=yes
	is_triggered_only = yes

	trigger = {
		from = {
			has_country_flag = cg_plus_slaver_country
		}
	}
	immediate = {
		if = {
			limit = { exists = event_target:cg_plus_slaver_country  }
			country_event = {
				id = cg_plus_enclave_slaver.1000
			}
		}
	}
}


# 1999 first contact

country_event = {
	id = cg_plus_enclave_slaver.1999
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name

	

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		from = {
			has_country_flag = cg_plus_slaver_country
		}
	}

	desc = cg_plus_enclave_slaver.1999.desc.a


	immediate = {

	}

	option = {
		name = cg_plus_enclave_slaver.1999.a.o
		trigger = {
			has_country_flag = carnalism_flag
		}
		response_text = cg_plus_enclave_slaver.1999.a.r
		is_dialog_only = yes
	}

	option = {
		name = cg_plus_enclave_slaver.1999.b.o
		trigger = {
			has_country_flag = asceticism_flag
		}
		response_text = cg_plus_enclave_slaver.1999.b.r
		is_dialog_only = yes
	}

	option = {
		name = GOODBYE
	}

}

country_event = {
	id = cg_plus_enclave_slaver.1900
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		event_target:cg_plus_slaver_country = {
			has_country_flag = slave_full
		}
	}

	desc = cg_plus_enclave_slaver.1900



	option = {
		name = cg_plus_enclave_slaver.1900.a
		country_event = {
			id = cg_plus_enclave_slaver.1000
		}
	}

	option = {
		name = GOODBYE
	}
}

# 0102 list captured
# 0103 list ruler auction
# 0104 tech up
# 02xx show captured leader
country_event = {
	id = cg_plus_enclave_slaver.1000
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name

	

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		exists = event_target:cg_plus_slaver_country  
	}

	desc = cg_plus_enclave_slaver.1000.desc.a
	desc = cg_plus_enclave_slaver.1000.desc.b
	desc = cg_plus_enclave_slaver.1000.desc.c
	desc = cg_plus_enclave_slaver.1000.desc.d

	immediate = {

	}
#info
	option = {
		name = cg_plus_enclave_slaver.1000.a.o
		hidden_effect = {
			country_event = {
				id = cg_plus_enclave_slaver.0101
			}
		}

	}
#share tech
	option = {
		name = cg_plus_enclave_slaver.1000.b.o
		trigger={ has_country_flag=carnalism_flag }
		hidden_effect = {
			country_event = {
				id = cg_plus_enclave_slaver.0104
			}
		}

	}
#check slave
	option = {
		name = cg_plus_enclave_slaver.1000.c.o
		hidden_effect = {
			country_event = {
				id = cg_plus_enclave_slaver.0102
			}
		}
	}
#check ruler slave
	option = {
		name = cg_plus_enclave_slaver.1000.d.o
		trigger = {
			event_target:cg_plus_slaver_country = {
				has_country_flag = cg_plus_slaver_captured_ruler
			}
			
		}
		hidden_effect = {
			country_event = {
				id = cg_plus_enclave_slaver.0105
			}
		}
	}


	option = {
		name = GOODBYE
	}

}
#0101 desc
country_event = {
	id = cg_plus_enclave_slaver.0101
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name

	

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		exists = event_target:cg_plus_slaver_country  
	}

	desc = cg_plus_enclave_slaver.0101.desc.a


	immediate = {

	}

	option = {
		name = cg_plus_enclave_slaver.0101.a.o
		response_text = cg_plus_enclave_slaver.0101.a.r
		is_dialog_only = yes
	}

	option = {
		name = cg_plus_enclave_slaver.0101.b.o
		response_text = cg_plus_enclave_slaver.0101.b.r
		is_dialog_only = yes
	}

	option = {
		name = cg_plus_enclave_slaver.0101.c.o
		response_text = cg_plus_enclave_slaver.0101.c.r
		is_dialog_only = yes
	}


	option = {
		name = BACK
	}
	after = {
		country_event = {
			id = cg_plus_enclave_slaver.1000
		}
	}

}


country_event = {
	id = cg_plus_enclave_slaver.0104
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		exists = event_target:cg_plus_slaver_country  
	}

	desc = cg_plus_enclave_slaver.0104.desc.a


	immediate = {

	}

	option = {
		name = cg_plus_enclave_slaver.0104.a.o  # 淫梦幻剂
		trigger={ has_technology= tech_lust_dream_fantasy always=no  
			event_target:cg_plus_slaver_country={NOT={ has_country_flag=tech_shared_01 }}}
		hidden_effect={ event_target:cg_plus_slaver_country={ set_country_flag=tech_shared_01 } }
		response_text = cg_plus_enclave_slaver.0104.a.r
		is_dialog_only = yes
	}

	option = {
		name = cg_plus_enclave_slaver.0104.b.o  # 美丽学说
		trigger={ has_technology = tech_beauty_theory  
			event_target:cg_plus_slaver_country={NOT={ has_country_flag=tech_shared_02 }}}
		hidden_effect={ event_target:cg_plus_slaver_country={ set_country_flag=tech_shared_02 } }
		response_text = cg_plus_enclave_slaver.0104.b.r
		is_dialog_only = yes
	}

	option = {
		name = cg_plus_enclave_slaver.0104.c.o # 快感神经植入术 
		trigger={ has_technology = tech_nerve_implantation always=no   
			event_target:cg_plus_slaver_country={NOT={ has_country_flag=tech_shared_03 }}}
		hidden_effect={ event_target:cg_plus_slaver_country={ set_country_flag=tech_shared_03 } }
		response_text = cg_plus_enclave_slaver.0104.c.r
		is_dialog_only = yes
	}

	option = {
		name = cg_plus_enclave_slaver.0104.d.o # 定向基因重塑
		trigger={ has_technology = tech_gene_remodeling    
			event_target:cg_plus_slaver_country={NOT={ has_country_flag=tech_shared_04 }}}
		hidden_effect={ event_target:cg_plus_slaver_country={ set_country_flag=tech_shared_04 } }
		response_text = cg_plus_enclave_slaver.0104.d.r
		is_dialog_only = yes
	}

	option = {
		name = BACK
	}
	after = {
		country_event = {
			id = cg_plus_enclave_slaver.1000
		}
	}

}


#list slaves
country_event = {
	id = cg_plus_enclave_slaver.0102
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name


	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		exists = event_target:cg_plus_slaver_country  
	}

	desc =cg_plus_enclave_slaver.0102.desc

	immediate = {

	}

	option = {
		allow={ always=no }
		name =  cg_plus_enclave_slaver.0102.list
	}

	option = {
		trigger={  event_target:cg_plus_slaver_country ={has_country_flag = slave_01_filled  }}
		allow={ custom_tooltip={  text=slave_sold event_target:cg_plus_slaver_captured_01={NOT={has_leader_flag=sold}}  }  }
		name =  cg_plus_enclave_slaver.0102.list.01
		country_event = { id = cg_plus_enclave_slaver.0201 }
	}

	option = {
		trigger={  event_target:cg_plus_slaver_country ={has_country_flag = slave_02_filled  }}
		allow={ custom_tooltip={  text=slave_sold event_target:cg_plus_slaver_captured_02={NOT={has_leader_flag=sold}}  }  }
		name =  cg_plus_enclave_slaver.0102.list.02
		country_event = { id = cg_plus_enclave_slaver.0202 }
	}
	option = {
		trigger={ event_target:cg_plus_slaver_country ={ has_country_flag = slave_03_filled  }}
		allow={ custom_tooltip={  text=slave_sold event_target:cg_plus_slaver_captured_03={NOT={has_leader_flag=sold}}  }  }
		name =  cg_plus_enclave_slaver.0102.list.03
		country_event = { id = cg_plus_enclave_slaver.0203 }
	}
	option = {
		trigger={  event_target:cg_plus_slaver_country ={has_country_flag = slave_04_filled  }}
		allow={ custom_tooltip={  text=slave_sold event_target:cg_plus_slaver_captured_04={NOT={has_leader_flag=sold}}  }  }
		name =  cg_plus_enclave_slaver.0102.list.04
		country_event = { id = cg_plus_enclave_slaver.0204 }

	}
	option = {
		trigger={  event_target:cg_plus_slaver_country ={has_country_flag = slave_05_filled  }}
		allow={ custom_tooltip={  text=slave_sold event_target:cg_plus_slaver_captured_05={NOT={has_leader_flag=sold}}  }  }
		name =  cg_plus_enclave_slaver.0102.list.05
		country_event = { id = cg_plus_enclave_slaver.0205 }
	}
	
	option={
		name= cg_plus_enclave_slaver.0102.list.empty
		trigger = {
			event_target:cg_plus_slaver_country ={
				NAND={
					has_country_flag = slave_01_filled
					has_country_flag = slave_02_filled
					has_country_flag = slave_03_filled
					has_country_flag = slave_04_filled	
					has_country_flag = slave_05_filled  
				}
			}
		}
		is_dialog_only=yes
		response_text=cg_plus_enclave_slaver.0102.desc
	}



	option = {
		name = BACK
		hidden_effect = {
			country_event = {
				id =  cg_plus_enclave_slaver.1000
			}
		}
	}


}


country_event = {
	id = cg_plus_enclave_slaver.0201
	hide_window = no
	title = cg_plus_enclave_slaver.0201.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_captured_01
		room = "prison_01_room"
	}
	immediate = { event_target:cg_plus_slaver_captured_01={ save_global_event_target_as  = conversation_with }
			      event_target:cg_plus_slaver_captured_01_origin={ save_global_event_target_as  = conversation_with_origin  }
					  }
	trigger = { exists = event_target:cg_plus_slaver_country  }
	desc = cg_plus_enclave_slaver.0201.desc


	option = { name = conversion is_dialog_only = yes  response_text = cg_plus_enclave_slaver.random.text  }
	option = { allow={ custom_tooltip={text=wait_for_other_first  NOT={ has_country_flag=has_bought_slave  }  } } 
		name = cg_plus_enclave_slaver.buy_slave event_target:cg_plus_slaver_captured_01={ save_global_event_target_as=buy_target }
		remove_country_flag=init_price  country_event = {  id = cg_plus_enclave_slaver.8000 }}
	option={ name=BACK country_event = {  id = cg_plus_enclave_slaver.0102 }}
	after = {  }
}

country_event = {
	id = cg_plus_enclave_slaver.0202
	hide_window = no
	title = cg_plus_enclave_slaver.0202.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_captured_02
		room = "prison_01_room"
	}
	immediate = { event_target:cg_plus_slaver_captured_02={ save_global_event_target_as  = conversation_with     } 
	event_target:cg_plus_slaver_captured_02_origin={ save_global_event_target_as  = conversation_with_origin  } }
	
	trigger = { exists = event_target:cg_plus_slaver_country  }
	desc = cg_plus_enclave_slaver.0202.desc
	option = { name = conversion is_dialog_only = yes  response_text = cg_plus_enclave_slaver.random.text  }
	option = { allow={ custom_tooltip={text=wait_for_other_first  NOT={ has_country_flag=has_bought_slave  }  } } 
		name = cg_plus_enclave_slaver.buy_slave event_target:cg_plus_slaver_captured_02={ save_global_event_target_as=buy_target }
		remove_country_flag=init_price  country_event = {  id = cg_plus_enclave_slaver.8000 } }
	option={ name=BACK country_event = {  id = cg_plus_enclave_slaver.0102 }}
	after = {  }
}

country_event = {
	id = cg_plus_enclave_slaver.0203
	hide_window = no
	title = cg_plus_enclave_slaver.0203.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_captured_03
		room = "prison_02_room"
		 }
		 immediate = { event_target:cg_plus_slaver_captured_03={ save_global_event_target_as  = conversation_with     } 
		 event_target:cg_plus_slaver_captured_03_origin={ save_global_event_target_as  = conversation_with_origin  } }
	
	trigger = { exists = event_target:cg_plus_slaver_country  }
	desc = cg_plus_enclave_slaver.0203.desc
	option = { name = conversion is_dialog_only = yes  response_text = cg_plus_enclave_slaver.random.text  }
	option = { allow={ custom_tooltip={text=wait_for_other_first  NOT={ has_country_flag=has_bought_slave  }  } } 
		name = cg_plus_enclave_slaver.buy_slave event_target:cg_plus_slaver_captured_03={ save_global_event_target_as=buy_target } 
		remove_country_flag=init_price  country_event = {  id = cg_plus_enclave_slaver.8000 }}
	option={ name=BACK country_event = {  id = cg_plus_enclave_slaver.0102 } }
	after = {  }
}

country_event = {
	id = cg_plus_enclave_slaver.0204
	hide_window = no
	title = cg_plus_enclave_slaver.0204.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_captured_04
		room = "prison_02_room"
	}
	immediate = { event_target:cg_plus_slaver_captured_04={ save_global_event_target_as  = conversation_with     }
	event_target:cg_plus_slaver_captured_04_origin={ save_global_event_target_as  = conversation_with_origin  }  }
	
	trigger = { exists = event_target:cg_plus_slaver_country  }
	desc = cg_plus_enclave_slaver.0204.desc
	option = { name = conversion is_dialog_only = yes  response_text = cg_plus_enclave_slaver.random.text  }
	option = { allow={ custom_tooltip={text=wait_for_other_first  NOT={ has_country_flag=has_bought_slave  }  } } 
		name = cg_plus_enclave_slaver.buy_slave event_target:cg_plus_slaver_captured_04={ save_global_event_target_as=buy_target }
		remove_country_flag=init_price  country_event = {  id = cg_plus_enclave_slaver.8000 }
	}
	option={ name=BACK country_event = {  id = cg_plus_enclave_slaver.0102 }}
	after = {  }
}

country_event = {
	id = cg_plus_enclave_slaver.0205
	hide_window = no
	title = cg_plus_enclave_slaver.0205.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_captured_05
		room =  "prison_02_room"
	}
	immediate = { event_target:cg_plus_slaver_captured_05={ save_global_event_target_as  = conversation_with     }
	event_target:cg_plus_slaver_captured_05_origin={ save_global_event_target_as  = conversation_with_origin  }  }
	
	trigger = { exists = event_target:cg_plus_slaver_country  }
	desc = cg_plus_enclave_slaver.0205.desc
	option = { name = conversion is_dialog_only = yes  response_text = cg_plus_enclave_slaver.random.text  }
	option = { allow={ custom_tooltip={text=wait_for_other_first  NOT={ has_country_flag=has_bought_slave  }  } } 
	name = cg_plus_enclave_slaver.buy_slave event_target:cg_plus_slaver_captured_05={ save_global_event_target_as=buy_target }
	remove_country_flag=init_price  country_event = {  id = cg_plus_enclave_slaver.8000 }
	}
	option={ name=BACK country_event = {  id = cg_plus_enclave_slaver.0102 }}
	after = {  }
}

#option check ruler
country_event = {
	id = cg_plus_enclave_slaver.0105
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name


	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		exists = event_target:cg_plus_slaver_country  
	}

	desc =cg_plus_enclave_slaver.0105.desc


#info
	option = {
		name = cg_plus_enclave_slaver.0105.1.o
		is_dialog_only = yes
		response_text = cg_plus_enclave_slaver.0105.1.r
	}
# check ruler
	option = {
		name = cg_plus_enclave_slaver.0105.2.o
		hidden_effect = {
			country_event = {
				id = cg_plus_enclave_slaver.0300
			}
		}
	}
# auction screen
	option = {
		allow = {
			fail_text = {
				text = auction_not_started_yet
				event_target:cg_plus_slaver_country  ={
					has_global_flag = cg_auction_started
				}
			}

			
		}
		name = cg_plus_enclave_slaver.0105.3.o
		hidden_effect = {
			country_event = {
				id = cg_plus_enclave_slaver.9050
			}
		}

	}
	option={ name=BACK  
		hidden_effect = {
			country_event = {
				id = cg_plus_enclave_slaver.1000
		}
	}

	}


}


country_event = {
	id = cg_plus_enclave_slaver.0300
	hide_window = no
	title = cg_plus_enclave_slaver.0300.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_captured_ruler
		room = "prison_01_room"
	}
	trigger = { exists = event_target:cg_plus_slaver_country  }
	desc = cg_plus_enclave_slaver.0300.desc
	option = { name = conversion is_dialog_only = yes  response_text = cg_plus_enclave_slaver.random.text  }
	
	option={ name=GOODBYE }
	after = { country_event = {  id = cg_plus_enclave_slaver.0105 } }
}


# 590x captured processing

# 5x01  notification event (victim Country)
# 5x01  notification event



# 54xx country destroyed, capture some leaders

# get planet general leader
# 51xx
# on_planet_defenders_lose 
# Triggers country_event for the defender upon defeat
# This = country, planet owner
# From = country, attack leader
# FromFrom = planet

# 52xx
# on_ship_disengaged_victim    get scientist or admiral
# # This = owner of ship 1 (destroyed)
# From = owner of ship 2 (combatant)
# FromFrom = ship 1
# FromFromFrom = ship 2

# 53xx on_fleet_destroyed_victim     get scientist or admiral
# This = owner of fleet 1 (destroyed)
# From = owner of fleet 2 (combatant)
# FromFrom = fleet 1
# FromFromFrom = fleet 2
# on_fleet_destroyed_victim

# 54xx country destroyed, capture some leaders
# on_country_destroyed 
#This = destroyed country
#From = optional, destroyer (country)
#
#

country_event = {
	id=cg_plus_enclave_slaver.5100
	is_triggered_only = yes
	hide_window = yes
	trigger = {
		exists = fromfrom
		exists = fromfrom.leader
		
		event_target:cg_plus_slaver_country={ NOT={  has_country_flag   = slave_full }}
	}
	immediate = {
		event_target:cg_plus_slaver_country={
			change_variable = {
				which = capture_roll
				value = 1
			}
		}
		fromfrom={  leader={  if={ limit={  is_anime_species=yes  }  
				random_list = {
					1={
						set_leader_flag = cg_slaver_captured
						exile_leader_as = saved_leader_temp
						assign_captured_normal_leader_to_slot = yes 
						set_global_flag = cg_slave_captured
						save_event_target_as  =saved_leader_temp_target
						This.owner={ save_global_event_target_as=captured_from_country }
					}
					15={modifier={ factor=0 has_global_flag=cg_plus_debug   }  }
				}
				
	
		} } } 
	}
	after = {
		if={
			limit={ has_global_flag = cg_slave_captured }
			event_target:saved_leader_temp_target={
				
				#set_leader = saved_leader_temp  # move leader to slaver
					switch = {
						trigger =  leader_class  
						admiral={ event_target:cg_plus_slaver_admiral_holder={ set_leader = saved_leader_temp   }  }
						general={ event_target:cg_plus_slaver_general_holder ={ set_leader = saved_leader_temp }      }
						governor={ event_target:cg_plus_slaver_governer_holder={ set_leader = saved_leader_temp }   
								event_target:saved_leader_temp={ assign_leader=Owner.capital_scope.sector } }
						scientist={  event_target:cg_plus_slaver_scientist_holder={ set_leader = saved_leader_temp   }   }
					}
				

				#country_event = {
				#	id = cg_plus_enclave_slaver.5901
				#	days =10
				#}
			}
			event_target:cg_plus_last_captured_origin={
				country_event={
						id=cg_plus_enclave_slaver.5101
						days=10
				}
			}
			remove_global_flag  = cg_slave_captured
		}
	}
}

country_event = {
	id= cg_plus_enclave_slaver.5101
	title= cg_plus_enclave_slaver.5101
	is_triggered_only = yes
	picture=GFX_evt_surrender
	desc= cg_plus_enclave_slaver.5101.desc
	immediate = {
		hidden_effect = {
			event_target:cg_plus_slaver_country={
				set_leader =event_target:slave_trader_leader
			}
		}
	}
	option={ name=UNFORTUNATE }
}


country_event = {
	id=cg_plus_enclave_slaver.5200
	is_triggered_only = yes
	hide_window = yes
	trigger = {
		exists = fromfrom
		exists = fromfrom.fleet.leader
		event_target:cg_plus_slaver_country={ NOT={  has_country_flag   = slave_full }}
	}
	immediate = {
		event_target:cg_plus_slaver_country={
			change_variable = {
				which = capture_roll
				value = 1
			}
		}
		fromfrom={ fleet={ leader={  if={ limit={  is_anime_species=yes  }  
				random_list = {
					1={
						set_leader_flag = cg_slaver_captured
						exile_leader_as = saved_leader_temp
						set_global_flag = cg_slave_captured
						assign_captured_normal_leader_to_slot = yes 
						save_event_target_as  =saved_leader_temp_target
						this.owner={ save_event_target_as=captured_from_country }
					}
					15={modifier={ factor=0 has_global_flag=cg_plus_debug   } }
				}
				
	
		} } } }
	}
	after = {
		if={
			limit={ has_global_flag = cg_slave_captured }
			event_target:saved_leader_temp_target={
				
				#set_leader = saved_leader_temp  # move leader to slaver
					switch = {
						trigger =  leader_class  
						admiral={ event_target:cg_plus_slaver_admiral_holder={ set_leader = saved_leader_temp   }  }
						general={ event_target:cg_plus_slaver_general_holder ={ set_leader = saved_leader_temp }      }
						governor={ event_target:cg_plus_slaver_governer_holder={ set_leader = saved_leader_temp }   
								event_target:saved_leader_temp={ assign_leader=Owner.capital_scope.sector } }
						scientist={  event_target:cg_plus_slaver_scientist_holder={ set_leader = saved_leader_temp   }   }
					}
			}
			event_target:cg_plus_last_captured_origin={
			country_event={
					id=cg_plus_enclave_slaver.5201
					days=10
			}}
			remove_global_flag  = cg_slave_captured
		}
	}
}

country_event = {
	id= cg_plus_enclave_slaver.5201
	title= cg_plus_enclave_slaver.5201
	is_triggered_only = yes
	picture=GFX_evt_debris
	desc= cg_plus_enclave_slaver.5201.desc
	immediate = {
		hidden_effect = {
			event_target:cg_plus_slaver_country={
				set_leader =event_target:slave_trader_leader
			}
		}
	}
	option={ name=UNFORTUNATE }
}



country_event = {
	id=cg_plus_enclave_slaver.5300
	is_triggered_only = yes
	hide_window = yes
	trigger = {
		exists = fromfrom
		exists = fromfrom.leader
		event_target:cg_plus_slaver_country={ NOT={  has_country_flag   = slave_full }}
	}
	immediate = {
		event_target:cg_plus_slaver_country={
			change_variable = {
				which = capture_roll
				value = 1
			}
		}
		fromfrom={  leader={  if={ limit={ species = { is_anime_species=yes } }  
				random_list = {
					1={
						set_leader_flag = cg_slaver_captured
						exile_leader_as = saved_leader_temp
						set_global_flag = cg_slave_captured
						assign_captured_normal_leader_to_slot = yes 
						save_event_target_as   = saved_leader_temp_target
						this.owner={ save_event_target_as=captured_from_country }
					}
					15={modifier={ factor=0 has_global_flag=cg_plus_debug   } }
				}
				
	
		} } } 
	}
	after = {
		if={
			limit={ has_global_flag = cg_slave_captured }
			#event_target:cg_plus_slaver_country={
			#	set_leader = saved_leader_temp 
			#}
			event_target:cg_plus_last_captured_origin={
			country_event={
					id=cg_plus_enclave_slaver.5301
					days=10
			}}
			remove_global_flag  = cg_slave_captured
		}
	}
}

country_event = {
	id= cg_plus_enclave_slaver.5301
	title= cg_plus_enclave_slaver.5301
	is_triggered_only = yes
	hide_window = no
	picture=GFX_evt_small_space_battle
	desc= cg_plus_enclave_slaver.5301.desc 
	immediate = {
		hidden_effect = {
			event_target:saved_leader_temp_target={
				
				#set_leader = saved_leader_temp  # move leader to slaver
					switch = {
						trigger =  leader_class  
						admiral={ event_target:cg_plus_slaver_admiral_holder={ set_leader = saved_leader_temp   }  }
						general={ event_target:cg_plus_slaver_general_holder ={ set_leader = saved_leader_temp }      }
						governor={ event_target:cg_plus_slaver_governer_holder={ set_leader = saved_leader_temp }   
								event_target:saved_leader_temp={ assign_leader=Owner.capital_scope.sector } }
						scientist={  event_target:cg_plus_slaver_scientist_holder={ set_leader = saved_leader_temp   }   }
					}
				

				#country_event = {
				#	id = cg_plus_enclave_slaver.5901
				#	days =10
				#}
			}
			hidden_effect = {
				event_target:cg_plus_slaver_country={
					set_leader =event_target:slave_trader_leader
				}
			}
		}
	}
	option={ name=UNFORTUNATE }
}




#capture ruler
country_event = {
	id=cg_plus_enclave_slaver.5400
	is_triggered_only = yes
	hide_window = yes
	trigger = {
		event_target:cg_plus_slaver_country={ NOT={  has_country_flag   = cg_plus_slaver_captured_ruler }}
		this = {
			is_regular_empire = yes
		}
	}
	immediate = {
		event_target:cg_plus_slaver_country={
			change_variable = {
				which = capture_roll
				value = 1
			}
		}
		this={  ruler={  if={ limit={  is_anime_species=yes  }  

						set_leader_flag = cg_slaver_captured
						exile_leader_as = saved_leader_temp
						#assign_captured_normal_leader_to_slot = yes                                     
						save_global_event_target_as = cg_plus_slaver_captured_ruler
						Root={ save_global_event_target_as = cg_plus_slaver_captured_ruler_origin }
						save_global_event_target_as = cg_plus_slaver_last_captured
						set_leader_flag = cg_plus_slaver_captured_ruler
						event_target:cg_plus_slaver_country={ set_country_flag = cg_plus_slaver_captured_ruler }


					}

				
	
		} }  
	}
	after = {
		
			#limit={ has_global_flag = cg_slave_captured }
			event_target:cg_plus_slaver_country={
				set_leader = saved_leader_temp 
			}
			every_playable_country={
				country_event = {
					id=cg_plus_enclave_slaver.5401
					days=10
				}

			}
			remove_global_flag  = cg_slave_captured
		
		event_target:cg_plus_slaver_country={
			country_event = {
				id = cg_plus_enclave_slaver.9000
				days=180
			}
			
		}
	}
}

country_event = {
	id= cg_plus_enclave_slaver.5401
	title= cg_plus_enclave_slaver.5401
	is_triggered_only = yes
	picture=GFX_evt_auction_0
	desc= cg_plus_enclave_slaver.5401.desc
	immediate = {
		hidden_effect = {
			event_target:cg_plus_slaver_country={
				set_leader =event_target:slave_trader_leader
			}
		}
	}
	option={ name=OK }
}

























# 60xx debug capture leaders



#capture random leader in this country
#this = leader country,being captured
country_event = {
	id= cg_plus_enclave_slaver.6000
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		is_anime_species = yes
	}
	immediate = {
		if = {
			limit = { event_target:cg_plus_slaver_country={ NOT={  has_country_flag   = slave_full }}}
				random_owned_leader={
					limit = {
						
						#is_organic_species = yes
						
						is_anime_species = yes  
						OR = {
							leader_class = admiral
							leader_class = general
							leader_class = governor
							leader_class = scientist

						}
					}
					set_leader_flag = cg_slaver_captured
					exile_leader_as = saved_leader_temp
					save_global_event_target_as = saved_leader_temp_target
					assign_captured_normal_leader_to_slot = yes #brand leader
				}
		}
	}
	after = {
		if = {
			limit = { event_target:cg_plus_slaver_country={ NOT={  has_country_flag   = slave_full }}}
		
			event_target:saved_leader_temp_target={
				
				#set_leader = saved_leader_temp  # move leader to slaver
					switch = {
						trigger =  leader_class  
						admiral={ event_target:cg_plus_slaver_admiral_holder={ set_leader = saved_leader_temp   }  }
						general={ event_target:cg_plus_slaver_general_holder ={ set_leader = saved_leader_temp }      }
						governor={ event_target:cg_plus_slaver_governer_holder={ set_leader = saved_leader_temp }   
								event_target:saved_leader_temp={ assign_leader=Owner.capital_scope.sector } }
						scientist={  event_target:cg_plus_slaver_scientist_holder={ set_leader = saved_leader_temp   }   }
					}
				

				#country_event = {
				#	id = cg_plus_enclave_slaver.5901
				#	days =10
				#}
			}

		}
	}
}

# country_event = {
# 	id= cg_plus_enclave_slaver.6001
# 	hide_window = yes
# 	is_triggered_only = yes
# 	immediate = {
# 		event_target:cg_plus_slaver_country={
# 			set_leader = event_target:cg_enclave_slave_trader_leader

# 		}
# 	}

# }



#8xxxx buy process

#8000 buy process main
country_event = {
	id = cg_plus_enclave_slaver.8000
	hide_window = no
	title = cg_plus_enclave_slaver.8000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:buy_target
		room = "prison_01_room"
	}
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  NOT={ has_country_flag=has_bought_slave  }}
	immediate={
		#calculate price
		if={limit={NOT={ has_country_flag=init_price }}
			set_variable={
				which = temprpice_energy
				value = value:cg_slave_price
			}
			set_variable={
				which = temprpice_consumer_goods
				value = 0
			}
			set_variable={
				which = temprpice_love_juice
				value = 0
			}
			set_variable={
				which = temprpice_minor_artifact
				value = 0
			}
			set_variable={
				which = temprpice_rare_crystals
				value = 0
			}
			set_variable={
				which = temprpice_nanites
				value = 0
			}
			set_variable={
				which = temprpice_dark_matter
				value = 0
			}

			set_country_flag=init_price
		}







	}

	desc = cg_plus_enclave_slaver.8000.desc
	option =  { name = basic_modifications  hidden_effect={  country_event = {  id = cg_plus_enclave_slaver.8001 } } 
					allow={ custom_tooltip={text=basic_modification_selected event_target:buy_target={ 
						NOR={   
							has_leader_flag=training_obidence_training
							has_leader_flag=training_wife_training
							has_leader_flag=training_toilet_training
							has_leader_flag=training_pet_training
					} }} }
				}
	option =  { name = advance_modifications  hidden_effect={  country_event = {  id = cg_plus_enclave_slaver.8002 } } 
					allow={ custom_tooltip={text=advanced_modification_selected event_target:buy_target={ 
						NOR={   
							has_leader_flag=training_tentacle_equipment
							has_leader_flag=training_sensitivity_mod
							has_leader_flag=training_mecha_suit_training
							has_leader_flag=training_corruption_mod
					} }} }
				}
	
	option =  { name = knowledge_modifications  trigger={ event_target:cg_plus_slaver_country ={ has_country_flag= tech_shared_01} } hidden_effect={  country_event = {  id = cg_plus_enclave_slaver.8003 } } 
					allow={ custom_tooltip={text=knowledge_modification_selected event_target:buy_target={ 
						NOR={   
							has_leader_flag=change_to_governer
							has_leader_flag=change_to_general
							has_leader_flag=change_to_admiral
							has_leader_flag=change_to_scientist
					} }} }
				}
	
	option =  { name = appearence_modifications  trigger={ event_target:cg_plus_slaver_country ={ has_country_flag= tech_shared_02} } hidden_effect={  country_event = {  id = cg_plus_enclave_slaver.8004 } } 
				allow={ custom_tooltip={text=appearence_modification_selected event_target:buy_target={ 
								NOR={   
									has_leader_flag=change_appearence

							} }} }

			}
	
	option =  { name = trait_modifications  trigger={ event_target:cg_plus_slaver_country ={ has_country_flag= tech_shared_03} } hidden_effect={  country_event = {  id = cg_plus_enclave_slaver.8005 } } 
				allow={ custom_tooltip={text=trait_modification_selected event_target:buy_target={ 
					NOR={   
						has_leader_flag=change_appearence

				} }} }
				}
	
	option =  { name = species_modifications  trigger={  event_target:cg_plus_slaver_country ={ has_country_flag= tech_shared_04} } hidden_effect={  country_event = {  id = cg_plus_enclave_slaver.8006 } } 
				
				allow={ custom_tooltip={text=species_modification_selected event_target:buy_target={ 
					NOR={   
						has_leader_flag=change_species

				} }} }
			}
	
	option =  { name = CONFRIM_PAYMENT hidden_effect={  country_event = {  id = cg_plus_enclave_slaver.8100 } }     }
	#rollback clear all mod flags on leader
	option =  { name= RECONSIDER  
				event_target:buy_target ={
						clear_slave_leader_modification=yes
				}
				remove_country_flag=init_price
				country_event = {  id = cg_plus_enclave_slaver.1000 } }
	
}

#flag moddifications
#800x

country_event = {
	id = cg_plus_enclave_slaver.8001
	hide_window = no
	title = cg_plus_enclave_slaver.8000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {  portrait = event_target:buy_target  room = "prison_01_room"  }
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  NOT={ has_country_flag=has_bought_slave  }}
	desc = cg_plus_enclave_slaver.8001.desc
	#option, name, effect ct,  set price, flag leader
	option =  { name = training_obidence_training    
				custom_tooltip= training_obidence_training.ct          
				hidden_effect={event_target:buy_target={ set_leader_flag=training_obidence_training }
				change_variable={ which=temprpice_energy value=5000 }}}
	option =  { name = training_wife_training   
				custom_tooltip= training_wife_training.ct         
				hidden_effect={event_target:buy_target={ set_leader_flag=training_wife_training }
				change_variable={ which=temprpice_consumer_goods value=3000 }}}		
	option =  { name = training_toilet_training  
				custom_tooltip= training_toilet_training.ct     
				hidden_effect={event_target:buy_target={ set_leader_flag=training_toilet_training }   
				change_variable={ which=temprpice_love_juice value=4000 }}}	
	option =  { name = training_pet_training  
				custom_tooltip= training_pet_training.ct     
				hidden_effect={event_target:buy_target={ set_leader_flag=training_pet_training }  
				change_variable={ which=temprpice_love_juice value=2000 }
				change_variable={ which=temprpice_energy value=5000 }}	}
	
	option =  { name= BACK   }
	after= {  hidden_effect={  country_event={ id=cg_plus_enclave_slaver.8000 } } }
}

country_event = {
	id = cg_plus_enclave_slaver.8002
	hide_window = no
	title = cg_plus_enclave_slaver.8000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {  portrait = event_target:buy_target  room = "prison_01_room"  }
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  NOT={ has_country_flag=has_bought_slave  }}
	desc = cg_plus_enclave_slaver.8002.desc
	#option, name, effect ct,  set price, flag leader
	option =  { name = training_tentacle_equipment   
				custom_tooltip= training_tentacle_equipment.ct          
				hidden_effect={event_target:buy_target={ set_leader_flag=training_tentacle_equipment }
				change_variable={ which=temprpice_love_juice value=5000 }
				change_variable={ which=temprpice_rare_crystals value=1000 }
				change_variable={ which=temprpice_minor_artifact value=15 }}
				}
	option =  { name = training_sensitivity_mod   
				custom_tooltip= training_sensitivity_mod.ct         
				hidden_effect={event_target:buy_target={ set_leader_flag=training_sensitivity_mod }
				change_variable={ which=temprpice_energy value=10000 }
				change_variable={ which=temprpice_love_juice value=5000 }
				change_variable={ which=temprpice_minor_artifact value=15 }}
				}		
	option =  { name = training_mecha_suit_training  
				custom_tooltip= training_mecha_suit_training.ct     
				hidden_effect={event_target:buy_target={ set_leader_flag=training_mecha_suit_training }   
				change_variable={ which=temprpice_nanites value=30 }
				change_variable={ which=temprpice_energy value=20000 }
				change_variable={ which=temprpice_rare_crystals value=1000 }
				change_variable={ which=temprpice_minor_artifact value=30 }}
				}	
	option =  { name = training_corruption_mod 
				custom_tooltip= training_corruption_mod.ct     
				hidden_effect={event_target:buy_target={ set_leader_flag=training_corruption_mod }  
				change_variable={ which=temprpice_energy value=20000 }
				change_variable={ which=temprpice_dark_matter value=30 }
				change_variable={ which=temprpice_minor_artifact value=30 }}
			}	
	option =  { name= BACK   }
	after= {  hidden_effect={  country_event={ id=cg_plus_enclave_slaver.8000  } } }
}


country_event = {
	id = cg_plus_enclave_slaver.8003
	hide_window = no
	title = cg_plus_enclave_slaver.8000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {  portrait = event_target:buy_target  room = "prison_01_room"  }
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  NOT={ has_country_flag=has_bought_slave  }}
	desc = cg_plus_enclave_slaver.8003.desc
	#option, name, effect ct,  set price, flag leader  #governer
	option =  { name = change_to_governer  
				custom_tooltip= change_to_governer.ct          
				allow={ event_target:buy_target={ not={  leader_class = governor}  } }
				hidden_effect={event_target:buy_target={ set_leader_flag=change_to_governer }
				
				change_variable={ which=temprpice_energy value=5000 }
				
				change_variable={ which=temprpice_minor_artifact value=5 }}
				}
	option =  { name = change_to_scientist   
				custom_tooltip= change_to_scientist.ct         
				
				allow={ event_target:buy_target={  not={leader_class =   scientist}  }  }
				hidden_effect={event_target:buy_target={ set_leader_flag=change_to_scientist }
				change_variable={ which=temprpice_energy value=5000 }
				
				change_variable={ which=temprpice_minor_artifact value=5 }}
				}		
	option =  { name = change_to_admiral  
				custom_tooltip= change_to_admiral.ct     
				
				allow={ event_target:buy_target={ not={ leader_class = admiral}  } }
				hidden_effect={event_target:buy_target={ set_leader_flag=change_to_admiral }  
				change_variable={ which=temprpice_energy value=5000 }
	
				change_variable={ which=temprpice_minor_artifact value=5 }}
				}	
	option =  { name = change_to_general
				custom_tooltip= change_to_general.ct     
				allow={ event_target:buy_target={ not={leader_class = general}    } }
				hidden_effect={event_target:buy_target={ set_leader_flag=change_to_general }  
				change_variable={ which=temprpice_energy value=5000 }
				change_variable={ which=temprpice_minor_artifact value=5 }}
			}	
	option =  { name= BACK   }
	after= {  hidden_effect={  country_event={ id=cg_plus_enclave_slaver.8000  } } }
}

country_event = {
	id = cg_plus_enclave_slaver.8004
	hide_window = no
	title = cg_plus_enclave_slaver.8000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {  portrait = event_target:buy_target  room = "prison_01_room"  }
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  NOT={ has_country_flag=has_bought_slave  }}
	desc = cg_plus_enclave_slaver.8004.desc
	#option, name, effect ct,  set price, flag leader  #governer
	option =  { name = change_appearence  
				custom_tooltip= change_appearence.ct          
				hidden_effect={event_target:buy_target={ set_leader_flag=change_appearence }
				change_variable={ which=temprpice_energy value=5000 }		
				change_variable={ which=temprpice_consumer_goods value=5000 }}		
				}
	option =  { name= BACK   }
	after= {  hidden_effect={  country_event={ id=cg_plus_enclave_slaver.8000  } } }
}



country_event = {
	id = cg_plus_enclave_slaver.8005
	hide_window = no
	title = cg_plus_enclave_slaver.8000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {  portrait = event_target:buy_target  room = "prison_01_room"  }
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  NOT={ has_country_flag=has_bought_slave  }}
	desc = cg_plus_enclave_slaver.8005.desc
	#option, name, effect ct,  set price, flag leader  #governer

	option =  { name= BACK   }
	after= {  hidden_effect={  country_event={ id=cg_plus_enclave_slaver.8000  } } }


}




country_event = {
	id = cg_plus_enclave_slaver.8006
	hide_window = no
	title = cg_plus_enclave_slaver.8000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {  portrait = event_target:buy_target  room = "prison_01_room"  }
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  NOT={ has_country_flag=has_bought_slave  }}
	desc = cg_plus_enclave_slaver.8006.desc
	#option, name, effect ct,  set price, flag leader  #governer
	option =  { name = change_species 
				custom_tooltip= change_species.ct          
				hidden_effect={event_target:buy_target={ set_leader_flag=change_species }
				change_variable={ which=temprpice_energy value=5000 }		
				change_variable={ which=temprpice_consumer_goods value=5000 }		
				change_variable={ which=temprpice_rare_crystals value=2000 }}	
				}
	option =  { name= BACK   }
	after= {  hidden_effect={  country_event={ id=cg_plus_enclave_slaver.8000  } } }
}











#CONFIRM PAYMENT
country_event = {
	id = cg_plus_enclave_slaver.8100
	hide_window = no
	title = cg_plus_enclave_slaver.8100.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  }
	immediate={
		#calculate price
	}

	desc = cg_plus_enclave_slaver.8100.desc
	
	option =  { name = PAY  
				allow={

					resource_stockpile_compare = { resource = energy value >= 1 mult = temprpice_energy }
					resource_stockpile_compare = { resource = consumer_goods value >= 1 mult = temprpice_consumer_goods }
					resource_stockpile_compare = { resource = love_juice value >=1  mult = temprpice_love_juice }
					resource_stockpile_compare = { resource = minor_artifacts value >= 1 mult = temprpice_minor_artifact }
					resource_stockpile_compare = { resource = rare_crystals  value >= 1 mult = temprpice_rare_crystals  }
					resource_stockpile_compare = { resource = nanites value >= 1 mult = temprpice_nanites  }
					resource_stockpile_compare = { resource = sr_dark_matter value >= 1 mult = temprpice_dark_matter }
				}
	
				add_resource={  energy = -1 mult= temprpice_energy }   
				add_resource={  consumer_goods = -1 mult= temprpice_consumer_goods }   
				add_resource={  love_juice =-1 mult = temprpice_love_juice   }  
				add_resource={   minor_artifacts =-1  mult = temprpice_minor_artifact   }     
				add_resource={  rare_crystals= -1 mult =temprpice_rare_crystals   }     
				add_resource={  nanites= -1 mult = temprpice_nanites   }     
				add_resource={  sr_dark_matter= -1 mult = temprpice_dark_matter   }  


				
				
				
				hidden_effect={  country_event = {  id = cg_plus_enclave_slaver.8500 } }  }
	#rollback clear all mod flags on leader
	option =  { name= RECONSIDER  
				event_target:buy_target ={
						clear_slave_leader_modification=yes
				}
				remove_country_flag=init_price
				country_event = {  id = cg_plus_enclave_slaver.1000 } }
	
}







#confirmed payment, fire shipment event 8501, fire modifiy event chain 8502
country_event = {
	id = cg_plus_enclave_slaver.8500
	hide_window = no
	title = cg_plus_enclave_slaver.8500.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = { exists = event_target:cg_plus_slaver_country    exists =event_target:buy_target  }
	immediate={
		#calculate price
		event_target:buy_target={
			set_leader_flag=sold
			set_leader_flag=sold@Root
			save_event_target_as=bought_slave
		}
		set_country_flag=has_bought_slave
		country_event={    id=  cg_plus_enclave_slaver.8502 }

		country_event={   id= cg_plus_enclave_slaver.8501  days = 270  }
	}
	desc = cg_plus_enclave_slaver.8500.desc
	#rollback clear all mod flags on leader
	option =  { name=GOODBYE }
	
}

#training gate event
# check flags, fire train events
country_event = {
	id = cg_plus_enclave_slaver.8502
	hide_window = yes
	
	is_triggered_only = yes
	trigger={
		exists= event_target:buy_target

	}

	immediate = {
		
		event_target:buy_target={
			switch={
				#71x0 x=1 2 3 4
				trigger=has_leader_flag
				training_obidence_training= { Root= {country_event={   id= cg_plus_enclave_slaver.7110  days =120  }} }
				training_wife_training= { Root={country_event={   id= cg_plus_enclave_slaver.7120  days =120  } } }
				training_toilet_training= {  Root={country_event={   id= cg_plus_enclave_slaver.7130  days =120  }}  }
				training_pet_training= {  Root={country_event={   id= cg_plus_enclave_slaver.7140  days =120  }   }}
				default = {}
			}

			switch={
				#72x0 x=1 2 3 4
				trigger=has_leader_flag
				training_tentacle_equipment= { Root= {country_event={   id= cg_plus_enclave_slaver.7210  days =180  } } }
				training_sensitivity_mod= { Root= {country_event={   id= cg_plus_enclave_slaver.7220  days =180  }  }}
				training_mecha_suit_training= { Root= {country_event={   id= cg_plus_enclave_slaver.7230  days =180  }  }}
				training_corruption_mod= { Root= {country_event={   id= cg_plus_enclave_slaver.7240  days =180  }   }}
				default = {}
			}
			if={ 
				limit={
					OR={
						has_leader_flag=change_species
					}
				}
				Root= {country_event={   id= cg_plus_enclave_slaver.7310  days =30 }  }


			}

			if={ 
				limit={
					OR={
						has_leader_flag=change_appearence
					}
				}
				Root= {country_event={   id= cg_plus_enclave_slaver.7410  days =60  }}


			}


			if={ 
				limit={
					OR={
						has_leader_flag=change_to_governer
						has_leader_flag=change_to_scientist
						has_leader_flag=change_to_admiral
						has_leader_flag=change_to_general
					}
				}
				Root= {country_event={  id= cg_plus_enclave_slaver.7510  days =90  }}


			}

			# if={ 
			# 	limit={
					
			# 	}
			# #	country_event={   id= cg_plus_enclave_slaver.7610  days =220  }


			# }


		}

	}

	
}
# 7xxx training events
country_event = {
	id = cg_plus_enclave_slaver.7110
	#training_obidence_training
	title = cg_plus_enclave_slaver.7110.name
	desc = cg_plus_enclave_slaver.7110.desc
	is_triggered_only = yes
	trigger = { exists = event_target:buy_target      }
	picture = GFX_evt_DGZ
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=7110  }
	}
	option = {
		name = OK
		event_target:buy_target={  
			add_trait = leader_trait_obidient  
			switch = {
				trigger = leader_class
				admiral={ add_trait=leader_trait_brainwash_admiral }
				general={add_trait=leader_trait_brainwash_general}
				governor={add_trait=leader_trait_public_governer }
				scientist={add_trait=leader_trait_brainwash_explorer }
			}
	
		}
	}
	after={
		event_target:buy_target = {
			remove_leader_flag =    training_obidence_training
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.7120
	#training_obidence_training
	title = cg_plus_enclave_slaver.7120.name
	desc = cg_plus_enclave_slaver.7120.desc
	is_triggered_only = yes
	trigger = { exists = event_target:buy_target      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=7120  }
	}
	option = {
		name = OK
		event_target:buy_target={  add_trait = leader_trait_bride  			
		switch = {
			trigger = leader_class
			admiral={ add_trait=leader_trait_brainwash_admiral }
			general={add_trait=leader_trait_brainwash_general}
			governor={add_trait=leader_trait_public_governer }
			scientist={add_trait=leader_trait_brainwash_explorer }
		}}
		
	}
	after={
		event_target:buy_target = {
			remove_leader_flag =    training_wife_training
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.7130
	#training_obidence_training
	title = cg_plus_enclave_slaver.7130.name
	desc = cg_plus_enclave_slaver.7130.desc
	is_triggered_only = yes
	trigger = { exists = event_target:buy_target      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=7130  }
	}
	option = {
		name = OK
		event_target:buy_target={  add_trait = leader_trait_rbq 
		switch = {
			trigger = leader_class
			admiral={ add_trait=leader_trait_brainwash_admiral }
			general={add_trait=leader_trait_brainwash_general}
			governor={add_trait=leader_trait_public_governer }
			scientist={add_trait=leader_trait_brainwash_explorer }
		} }
	}
	after={
		event_target:buy_target = {
			remove_leader_flag =    training_toilet_training
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.7140
	#training_obidence_training
	title = cg_plus_enclave_slaver.7140.name
	desc = cg_plus_enclave_slaver.7140.desc
	is_triggered_only = yes
	trigger = { exists = event_target:buy_target      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave_p"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=7140  }
	}
	option = {
		name = OK
		event_target:buy_target={  add_trait = leader_trait_pet  
		switch = {
			trigger = leader_class
			admiral={ add_trait=leader_trait_brainwash_admiral }
			general={add_trait=leader_trait_brainwash_general}
			governor={add_trait=leader_trait_public_governer }
			scientist={add_trait=leader_trait_brainwash_explorer }
		}}
	}
	after={
		event_target:buy_target = {
			remove_leader_flag =    training_pet_training
		}
	}
}


country_event = {
	id = cg_plus_enclave_slaver.7210
	#training_obidence_training
	title = cg_plus_enclave_slaver.7210.name
	desc = cg_plus_enclave_slaver.7210.desc
	is_triggered_only = yes
	trigger = { exists = event_target:buy_target      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave_p"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=7210  }
	}
	option = {
		name = OK
		event_target:buy_target={  add_trait = leader_trait_living_clothes 
		switch = {
			trigger = leader_class
			admiral={ add_trait=leader_trait_slave_admiral }
			general={add_trait=leader_trait_slave_general}
			governor={add_trait=leader_trait_toy_governer }
			scientist={add_trait=leader_trait_slave_researcher }
		}
	}
	}
	after={
		event_target:buy_target = {
			remove_leader_flag =    training_tentacle_equipment
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.7220
	#training_obidence_training
	title = cg_plus_enclave_slaver.7220.name
	desc = cg_plus_enclave_slaver.7220.desc
	is_triggered_only = yes
	trigger = { exists = event_target:buy_target      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=7220  }
	}
	option = {
		name = OK
		event_target:buy_target={  add_trait = leader_trait_sense3000 
		switch = {
			trigger = leader_class
			admiral={ add_trait=leader_trait_slave_admiral }
			general={add_trait=leader_trait_slave_general}
			governor={add_trait=leader_trait_toy_governer }
			scientist={add_trait=leader_trait_slave_researcher }
		}}
	}
	after={
		event_target:buy_target = {
			remove_leader_flag =    training_sensitivity_mod
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.7230
	#training_obidence_training
	title = cg_plus_enclave_slaver.7230.name
	desc = cg_plus_enclave_slaver.7230.desc
	is_triggered_only = yes
	trigger = { exists = event_target:buy_target      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave_p"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=7230  
	}
	}
	option = {
		name = OK
		event_target:buy_target={  add_trait = leader_trait_ero_cybrog 
		switch = {
			trigger = leader_class
			admiral={ add_trait=leader_trait_slave_admiral }
			general={add_trait=leader_trait_slave_general}
			governor={add_trait=leader_trait_toy_governer }
			scientist={add_trait=leader_trait_slave_researcher }
		}}
	}
	after={
		event_target:buy_target = {
			remove_leader_flag =    training_mecha_suit_training
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.7240
	#training_obidence_training
	title = cg_plus_enclave_slaver.7240.name
	desc = cg_plus_enclave_slaver.7240.desc
	is_triggered_only = yes
	trigger = { exists = event_target:buy_target      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave_p"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=7240  }
	}
	option = {
		name = OK
		event_target:buy_target={  add_trait = leader_trait_dr_corrupt 
		switch = {
			trigger = leader_class
			admiral={ add_trait=leader_trait_slave_admiral }
			general={add_trait=leader_trait_slave_general}
			governor={add_trait=leader_trait_toy_governer }
			scientist={add_trait=leader_trait_slave_researcher }
		}}
	}
	after={
		event_target:buy_target = {
			remove_leader_flag =    training_corruption_mod
		}
	}
}


country_event = {
	id = cg_plus_enclave_slaver.7310
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:buy_target
		room = "ship_room"

	}
	trigger = { exists = event_target:buy_target      }
	immediate={	}
	desc = cg_plus_enclave_slaver.7310.desc
	#
	#change to main species
	#change to sub species

	option =  { name=cg_plus_enclave_slaver.7310.a 
					

					event_target:buy_target = {
						change_species =  root.owner_main_species
					}
					
				}
	option =  { name=cg_plus_enclave_slaver.7310.b 
				allow={ has_technology = tech_kinky_modification_project  }
				hidden_effect={
					create_species = {
						name = "inferior_rbq"
						name_list = "SUC1"
						class = Magical_Bitch			#-3
						portrait = "SWO"
						traits = {
							trait = trait_transformed_perfect_body				#改造尤物	-3	
							trait = trait_forever_naughty				#永远发情	2
							trait = trait_coquettish				#丰姿怡丽	2
							trait = trait_broken_fleshtoilet				#崩坏精壶	1
						}
					}
					event_target:buy_target = {
						change_species =  last_created_species

					}

				}

			}
	#option =  { name=cg_plus_enclave_slaver.7310.c }
	option =  { name=cg_plus_enclave_slaver.7310.c 
				allow={ has_technology = tech_alien_baptism  }
				hidden_effect={
					create_species = {
						name = "heartless_shojo"
						name_list = "FIJN"
						class = Magical_Girl			#-3
						portrait = "pure"
						traits = {
							trait = trait_baptized_perfect_body				#洗礼金身	-3
							trait = trait_heartless_shojo				#无心少女	1		
							trait = trait_inner_peace				#心如止水	2
							trait = trait_beautiful				#仙姿玉色	2
							trait = trait_virtuous				#冰清玉洁	1
						}
					}
					event_target:buy_target = {
						change_species =  last_created_species
					}

				}

			}



	after={
		event_target:buy_target = {
			remove_leader_flag =  change_species


		}
	}
	
}

# 740
country_event = {
	id = cg_plus_enclave_slaver.7410
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:buy_target
		room = "ship_room"
	}
	trigger = { exists = event_target:buy_target      }
	immediate={	}
	desc = cg_plus_enclave_slaver.7410.desc

	option={  name=  cg_plus_enclave_slaver.7410.a
			hidden_effect = {
				event_target:buy_target  ={
						change_leader_portrait_group_LoliGirl=yes
				}
				
					country_event = {
						id = cg_plus_enclave_slaver.7410
					}
				}
			}

	option={  name=  cg_plus_enclave_slaver.7410.b
			hidden_effect = {
			event_target:buy_target  ={
					# change_leader_portrait = LOLISUC  
					change_leader_portrait_group_Lolisuc=yes
			}
			country_event = {id = cg_plus_enclave_slaver.7410}}}

	option={  name=  cg_plus_enclave_slaver.7410.c
		hidden_effect = {
			event_target:buy_target  ={
					change_leader_portrait_group_oppaiuc = yes   
			}
			country_event = {id = cg_plus_enclave_slaver.7410}}}

	option={  name=  cg_plus_enclave_slaver.7410.d
			hidden_effect = {
			event_target:buy_target  ={
				change_leader_portrait_group_lustinn =yes
			}
			country_event = {id = cg_plus_enclave_slaver.7410}}}
	option={  name=  cg_plus_enclave_slaver.7410.e
			hidden_effect = {
			event_target:buy_target  ={
				change_leader_portrait_group_ELF =yes 
			}
			country_event = {id = cg_plus_enclave_slaver.7410}}}

	option={  name=  cg_plus_enclave_slaver.7410.end

			}
			after={
				event_target:buy_target = {
					remove_leader_flag =    change_appearence
				}
			}

}

country_event = {
	id = cg_plus_enclave_slaver.7510
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name
	is_triggered_only = yes

	desc = cg_plus_enclave_slaver.7510.desc
	picture = GFX_brainwash

	trigger = { exists = event_target:buy_target      }
	immediate={


		switch = {
			trigger =  has_leader_flag  
			change_to_admiral={ event_target:cg_plus_slaver_admiral_holder={ set_leader = event_target:buy_target   }  }
			change_to_general={ event_target:cg_plus_slaver_general_holder ={ set_leader = event_target:buy_target }      }
			change_to_governer={ event_target:cg_plus_slaver_governer_holder={ sector = {
				#set_leader=event_target:buy_target
				assign_leader = event_target:buy_target
			} }   }
			
			change_to_scientist={  event_target:cg_plus_slaver_scientist_holder={ set_leader = event_target:buy_target   }   }
		}


	}
	





	option = {
		trigger={ event_target:buy_target = { has_leader_flag=  change_to_admiral          }   }
		name = cg_plus_enclave_slaver.7510.a
	}
	option = {
		trigger={ event_target:buy_target = { has_leader_flag=  change_to_general          }   }
		name = cg_plus_enclave_slaver.7510.b
	}
	option = {
		trigger={ event_target:buy_target = { has_leader_flag=  change_to_governer          }   }
		name = cg_plus_enclave_slaver.7510.c
	}
	option = {
		trigger={ event_target:buy_target = { has_leader_flag=  change_to_scientist          }   }
		name = cg_plus_enclave_slaver.7510.d
	}




			after={
				event_target:buy_target = {
					remove_leader_flag=change_to_governer
					remove_leader_flag=change_to_scientist
					remove_leader_flag=change_to_admiral
					remove_leader_flag=change_to_general	
				}
			}

}























#8501 ship to country
country_event = {
	id = cg_plus_enclave_slaver.8501
	hide_window = no
	title = cg_plus_enclave_slaver.8501.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:bought_slave
		room = "ship_room"
	}
	trigger = { exists = event_target:bought_slave      }
	immediate={
		#calculate price

		event_target:cg_plus_slaver_country={ 
					if={ limit={ event_target:bought_slave={ has_leader_flag= cg_plus_slaver_captured_01 } }remove_country_flag = slave_01_filled } 
					else_if={ limit={ event_target:bought_slave={ has_leader_flag= cg_plus_slaver_captured_02 } }remove_country_flag = slave_02_filled }
					else_if={ limit={ event_target:bought_slave={ has_leader_flag= cg_plus_slaver_captured_03 } }remove_country_flag = slave_03_filled } 
					else_if={ limit={ event_target:bought_slave={ has_leader_flag= cg_plus_slaver_captured_04 } }remove_country_flag = slave_04_filled }  
					else_if={ limit={ event_target:bought_slave={ has_leader_flag= cg_plus_slaver_captured_05 } }remove_country_flag = slave_05_filled } 
					subtract_variable  = {which = total_slaves value = 1 } 
					remove_country_flag =slave_full
					}
		event_target:bought_slave={
						remove_leader_flag=sold
						remove_leader_flag=sold@Root
						remove_leader_flag=cg_plus_slaver_captured_01
						remove_leader_flag=cg_plus_slaver_captured_02
						remove_leader_flag=cg_plus_slaver_captured_03
						remove_leader_flag=cg_plus_slaver_captured_04
						remove_leader_flag=cg_plus_slaver_captured_05
			
					}
		event_target:bought_slave={ 

			exile_leader_as = temp_ship_leader

		
		}
		this.ruler={ save_global_event_target_as =  original_ruler         }
	}


	#check traits, make responds 
	desc = {
		
		trigger = {
			event_target:bought_slave={
			switch={
				trigger=has_trait 
				leader_trait_obidient={ text=cg_plus_enclave_slaver.8501.desc.1}
				leader_trait_bride={ text=cg_plus_enclave_slaver.8501.desc.2}
				leader_trait_rbq={ text=cg_plus_enclave_slaver.8501.desc.3}
				leader_trait_pet={ text=cg_plus_enclave_slaver.8501.desc.4}
				leader_trait_living_clothes={ text=cg_plus_enclave_slaver.8501.desc.5}
				leader_trait_sense3000={ text=cg_plus_enclave_slaver.8501.desc.6}
				leader_trait_ero_cybrog={ text=cg_plus_enclave_slaver.8501.desc.7}
				leader_trait_dr_corrupt={ text=cg_plus_enclave_slaver.8501.desc.8}
				default={ text=cg_plus_enclave_slaver.8501.desc}
				}
				}
			}
	}

	




	#rollback clear all mod flags on leader
	option =  { name=GOOD }
	after={
		hidden_effect={
		set_leader= temp_ship_leader
		

		event_target:bought_slave={ 
			unassign_leader = this
		}
		random_owned_leader = {
			unassign_leader = this
		}
		remove_country_flag=has_bought_slave
		country_event = {
			id = cg_plus_enclave_slaver.8503
			days=5
			}
		}


	}
	
}


country_event = {
	id = cg_plus_enclave_slaver.8503
	hide_window = yes
	
	is_triggered_only = yes
	immediate = {
		set_leader= event_target:original_ruler
	}
	after = {
		clear_global_event_target = original_ruler
	}

}

#sell slaves on regular when slaves >3
country_event = {
	id = cg_plus_enclave_slaver.8600
	hide_window = yes
	
	is_triggered_only = yes
	trigger = {
		has_country_flag= cg_plus_slaver_country
		event_target:cg_plus_slaver_country={
			check_variable = {
				which = total_slaves
				value > 3
			}
		}
	}
	immediate = {
		random_list = {
			10={}



			1={									
					random_list = {
						1={ modifier = { NOT={ has_country_flag = slave_01_filled } factor=0 }  
							modifier = { event_target:cg_plus_slaver_captured_01={ has_leader_flag=player_exclusive } factor=0 }       
							remove_country_flag = slave_01_filled
							clear_global_event_target = cg_plus_slaver_captured_01  
							event_target:cg_plus_slaver_captured_01={ kill_leader = { }  }
						}
						1={ modifier = { NOT={ has_country_flag = slave_02_filled } factor=0 }  
							modifier = { event_target:cg_plus_slaver_captured_02={ has_leader_flag=player_exclusive } factor=0 }       
   
							remove_country_flag = slave_02_filled
							clear_global_event_target = cg_plus_slaver_captured_02  
							event_target:cg_plus_slaver_captured_02={ kill_leader = { }  }
						}
						1={ modifier = { NOT={ has_country_flag = slave_03_filled } factor=0 }    
						modifier = { event_target:cg_plus_slaver_captured_03={ has_leader_flag=player_exclusive } factor=0 }       
  
							remove_country_flag = slave_03_filled
							clear_global_event_target = cg_plus_slaver_captured_03  
							event_target:cg_plus_slaver_captured_03={ kill_leader = { }  }
						}

						1={ modifier = { NOT={ has_country_flag = slave_04_filled } factor=0 }   
						modifier = { event_target:cg_plus_slaver_captured_04={ has_leader_flag=player_exclusive } factor=0 }       
   
							remove_country_flag = slave_04_filled
							clear_global_event_target = cg_plus_slaver_captured_04  
							event_target:cg_plus_slaver_captured_04={ kill_leader = { }  }
						}
						1={ modifier = { NOT={ has_country_flag = slave_05_filled } factor=0 }  
						modifier = { event_target:cg_plus_slaver_captured_05={ has_leader_flag=player_exclusive } factor=0 }       
    
							remove_country_flag = slave_05_filled
							clear_global_event_target = cg_plus_slaver_captured_05  
							event_target:cg_plus_slaver_captured_05={ kill_leader = { }  }
						}


					}
			}
		}
	}

}


























#clear all slaves
country_event = {
	id= cg_plus_enclave_slaver.6001
	hide_window = yes
	is_triggered_only = yes


	immediate = {
		event_target:cg_plus_slaver_country={
			remove_country_flag = slave_full
			set_variable = {
				which = slave_total
				value = 0
			}
			clear_global_event_target = cg_plus_slaver_captured_01
			clear_global_event_target = cg_plus_slaver_captured_02
			clear_global_event_target = cg_plus_slaver_captured_03
			clear_global_event_target = cg_plus_slaver_captured_04
			clear_global_event_target = cg_plus_slaver_captured_05
			event_target:cg_plus_slaver_captured_01={ kill_leader = { }  }
			event_target:cg_plus_slaver_captured_02={ kill_leader = { }  }
			event_target:cg_plus_slaver_captured_03={ kill_leader = { }  }
			event_target:cg_plus_slaver_captured_04={ kill_leader = { }  }
			event_target:cg_plus_slaver_captured_05={ kill_leader = { }  }
			remove_country_flag = slave_01_filled
			remove_country_flag = slave_02_filled
			remove_country_flag = slave_03_filled
			remove_country_flag = slave_04_filled
			remove_country_flag = slave_05_filled

		}
	}
}
country_event = {
	id= cg_plus_enclave_slaver.6002
	hide_window = yes
	is_triggered_only = yes


	immediate = {
		set_global_flag = cg_plus_debug
	}
}






country_event = {
	id = cg_plus_enclave_slaver.5901
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		event_target:cg_plus_slaver_last_captured={
			add_skill = 2
			add_trait = leader_trait_captured
			add_trait = leader_trait_naked



		}
	}



}

#9xxx
#auction events

# 9000 init and start auction event
# 9900 generate test auction           9901 #clear auction leader
# 9901 remove test auction    leader

#9900 generate test auction leader
country_event = {
	id = cg_plus_enclave_slaver.9900
	hide_window = yes
	is_triggered_only = yes
	immediate = {

		event_target:cg_plus_slaver_country = {
			
		

			create_leader = {
				class = scientist
				species = this
				name = "test_auction_leader"
				immortal = yes
			}
			set_leader = last_created_leader
			unassign_leader = last_created_leader


			last_created_leader = {
				
				set_leader_flag = cg_slaver_captured
				
				#assign_captured_normal_leader_to_slot = yes                                     
				save_global_event_target_as = cg_plus_slaver_captured_ruler
				Root={ save_global_event_target_as = cg_plus_slaver_captured_ruler_origin }
				#save_global_event_target_as = cg_plus_slaver_last_captured
				set_leader_flag = cg_plus_slaver_captured_ruler
				event_target:cg_plus_slaver_country={ set_country_flag = cg_plus_slaver_captured_ruler }
				
			}

		}

	}

}
#clear auction leader
country_event = {
	id = cg_plus_enclave_slaver.9901
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		event_target:cg_plus_slaver_country = {	
			event_target:cg_plus_slaver_captured_ruler = {
				
				remove_leader_flag = cg_slaver_captured
				remove_leader_flag = cg_plus_slaver_captured_ruler				
			}
			remove_country_flag = cg_plus_slaver_captured_ruler
		}
	}
	after = {
	#	clear_global_event_target = cg_plus_slaver_captured_ruler_origin
	#	clear_global_event_target = cg_plus_slaver_captured_ruler
	}

}




# 9000 init and start auction event
# 9001 daily update event  #fire counter event in slaver country
@auction_days = 181
#
country_event = {
	id = cg_plus_enclave_slaver.9000
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		exists = event_target:cg_plus_slaver_captured_ruler
		exists = event_target:cg_plus_slaver_country
	}
	
	immediate = {
		event_target:cg_plus_slaver_country = {	
			set_variable = {
				which = highest_bid_price
				value = 5000
			}
			#days
			set_variable={
				which = bid_time_left
				value = @auction_days
			}
			
		}
		random_playable_country = {
			save_global_event_target_as = cg_plus_auction_highest_bidder
		}
	}

	after = {
		event_target:cg_plus_slaver_country = {	
			set_global_flag =  cg_auction_started
				
				
			country_event = {
				id = cg_plus_enclave_slaver.9001
				days = 1
			}
		}
		every_playable_country = {
			limit = {
				is_ai = no
			}
			if={
					limit = {
						NOT={ has_established_contact = prev }
					}
					establish_contact = {
						who = THIS
					}

			}
			country_event = {
				id = cg_plus_enclave_slaver.9004
				
			}



		}











	}

}
#9001 daily update
#9002 ask ai to bid
# inform highest bidder changed
country_event = {
	id = cg_plus_enclave_slaver.9001
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		exists = event_target:cg_plus_slaver_captured_ruler
		exists = event_target:cg_plus_slaver_country
		has_global_flag =cg_auction_started
	}
	immediate = {
		subtract_variable = {
			which = bid_time_left
			value = 1
		}
		# do other stuff
		
		
		
		# highest bidder changed, inform player
		
			every_playable_country = {
				limit = { is_ai = no }
				if={ limit={  
					  NOT={	is_same_empire = event_target:cg_plus_auction_highest_bidder }
				 	}
					country_event = {  id = cg_plus_enclave_slaver.9003  }
				}
			}




		# ask ai to bid

		
		random_playable_country = {
			limit = { is_ai = yes 
			NOT={	is_same_empire = event_target:cg_plus_auction_highest_bidder }    }
			country_event = {  id = cg_plus_enclave_slaver.9002  }
		}

		



	}
	after = {
		if ={
			limit = {   check_variable = {
							which = bid_time_left
							value > 0 }	
				}
				country_event = {
					id = cg_plus_enclave_slaver.9001
					days = 1
				}
		}
		else ={
			#inform all playables auction ended
			remove_global_flag = cg_auction_started
			every_playable_country = {
				country_event = {
					id = cg_plus_enclave_slaver.9100
					days = 1
				}
			}
		}
	}
}
country_event = {
	id = cg_plus_enclave_slaver.9002
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		set_variable={  which=temp_bid_price  value=  event_target:cg_plus_slaver_country.highest_bid_price }
		random_list = {
			1={
				modifier={   add = 15  }
				#no bid


			}







			1={
				#raise bid

				modifier={ resource_stockpile_compare = { resource = energy value < 1 mult = temp_bid_price } 
							factor = 0.5
						}	


				set_variable={  which=temp_bid_price  value=  event_target:cg_plus_slaver_country.highest_bid_price }
				change_variable = {
					which = temp_bid_price
					value = 1000
				}
				save_global_event_target_as = cg_plus_auction_highest_bidder
				event_target:cg_plus_slaver_country = {	
					set_variable = {
						which = highest_bid_price
						value = prev.temp_bid_price
					}
				}
			}

			1={
				#raise bid

				modifier={ resource_stockpile_compare = { resource = energy value >= 1.5 mult = temp_bid_price } 
							factor = 3
						}	
				modifier={ resource_stockpile_compare = { resource = energy value < 1 mult = temp_bid_price } 
							factor = 0.1}	


				set_variable={  which=temp_bid_price  value=  event_target:cg_plus_slaver_country.highest_bid_price }
				change_variable = {
					which = temp_bid_price
					value = 1000
				}
				save_global_event_target_as = cg_plus_auction_highest_bidder
				event_target:cg_plus_slaver_country = {	
					set_variable = {
						which = highest_bid_price
						value = prev.temp_bid_price
					}
				}
			}

			1={
				#raise bid

				modifier={ resource_stockpile_compare = { resource = energy value >= 2.0 mult = temp_bid_price } 
							factor = 6
						}	
				modifier={ resource_stockpile_compare = { resource = energy value < 1 mult = temp_bid_price } 
							factor = 0.1}	

				set_variable={  which=temp_bid_price  value=  event_target:cg_plus_slaver_country.highest_bid_price }
				change_variable = {
					which = temp_bid_price
					value = 10000
				}
				save_global_event_target_as = cg_plus_auction_highest_bidder
				event_target:cg_plus_slaver_country = {	
					set_variable = {
						which = highest_bid_price
						value = prev.temp_bid_price
					}
				}
			}

			1={
				#raise bid

				modifier={ resource_stockpile_compare = { resource = energy value >= 2.5 mult = temp_bid_price } 
							factor = 10
						}
				modifier={ resource_stockpile_compare = { resource = energy value < 1 mult = temp_bid_price } 
							factor = 0.1}		


				set_variable={  which=temp_bid_price  value=  event_target:cg_plus_slaver_country.highest_bid_price }
				change_variable = {
					which = temp_bid_price
					value = 10000
				}
				save_global_event_target_as = cg_plus_auction_highest_bidder
				event_target:cg_plus_slaver_country = {	
					set_variable = {
						which = highest_bid_price
						value = prev.temp_bid_price
					}
				}
			}
		}
	}
}

# infomr player bid passed
country_event = {
	id = cg_plus_enclave_slaver.9003
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name
	is_triggered_only = yes
	diplomatic = yes
	desc = cg_plus_enclave_slaver.9003.text
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		exists = event_target:cg_plus_slaver_country  
		has_global_flag   = cg_auction_started
		NOT={  has_country_flag =informed_not_highest  }
	}
	immediate = {
		set_country_flag = informed_not_highest
	}

	option = {
		name =  cg_plus_enclave_slaver.9003.a
		#custom_tooltip = cg_plus_enclave_slaver.9003.a.t
		hidden_effect = {
			country_event={ id=cg_plus_enclave_slaver.9050 }
		}
	}
	option = {
		name = NOT_NOW
	}
}


# infomr player auction  started
country_event = {
	id = cg_plus_enclave_slaver.9004
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name
	is_triggered_only = yes
	diplomatic = yes
	desc = cg_plus_enclave_slaver.9004.text
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_country
		room = "ship_room"
	}
	trigger = {
		exists = event_target:cg_plus_slaver_country  
		has_global_flag   = cg_auction_started
	
	}
	immediate = {
		
	}

	option = {
		name =  cg_plus_enclave_slaver.9003.a
		#custom_tooltip = cg_plus_enclave_slaver.9003.a.t
		hidden_effect = {
			country_event={ id=cg_plus_enclave_slaver.9050 }
		}
	}
	option = {
		name = NOT_NOW
	}
}

# aucion ended,
country_event = {
	id = cg_plus_enclave_slaver.9100

	title= cg_plus_enclave_slaver.9100.name
	is_triggered_only = yes
	picture = GFX_evt_auction_sold ##TODO
	desc= cg_plus_enclave_slaver.9100.desc
	immediate={remove_global_flag = cg_auction_started}
	option = {
		#is bidder
		trigger = {
			is_same_empire = event_target:cg_plus_auction_highest_bidder
		}
		name = cg_plus_enclave_slaver.9100.a
		add_resource = {
			energy = -1
			mult = event_target:cg_plus_slaver_country.highest_bid_price
		}
		
		# do country event to move slave to country
		event_target:cg_plus_auction_highest_bidder={
			country_event = {
				id = cg_plus_enclave_slaver.9101
				
			}


		}

	}

	option = {
		#not _bidder
		trigger = {
			NOT= {is_same_empire = event_target:cg_plus_auction_highest_bidder }
		}
		name = UNFORTUNATE

	}
}


#9101 ship to country
country_event = {
	id = cg_plus_enclave_slaver.9101
	hide_window = no
	title = cg_plus_enclave_slaver.1000.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"
	picture_event_data = {
		portrait = event_target:cg_plus_slaver_captured_ruler
		room = "ship_room"
	}
	trigger = { exists = event_target:cg_plus_slaver_captured_ruler      }
	immediate={
		this.ruler={ save_global_event_target_as =  original_ruler         }
		#set_leader = event_target:cg_plus_slaver_captured_ruler


	}


	#check traits, make responds 
	desc = cg_plus_enclave_slaver.9101.desc

	




	#rollback clear all mod flags on leader
	#option =  { name=GOOD }
	#TODO 
	# add option to what to do with the prize

	option =  { allow={ 
					OR={
						event_target:cg_plus_slaver_captured_ruler={ species={ is_archetype= Magical_Girl } } 
						has_policy_flag = nun_uniform
					}
				} 
				# = { has_policy_flag = nun_uniform }
				name=cg_plus_enclave_slaver.9210.name
					country_event = {
						id = cg_plus_enclave_slaver.9210
						days=60
					}
	}

	option =  { 
		name=cg_plus_enclave_slaver.9220.name.o
		country_event = {
			id = cg_plus_enclave_slaver.9220
			days=60
		}
	}

	option =  { 
		name=cg_plus_enclave_slaver.9230.name.o
		
		allow = {
			is_robotic_species = yes
		}
		country_event = {
			id = cg_plus_enclave_slaver.9230
			days=60
		}
	}

	option =  { 
		name=cg_plus_enclave_slaver.9240.name.o
		allow = {
			OR={
			has_met_primitives = yes
			has_policy_flag = pre_sapients_allow
			has_policy_flag = pre_sapients_protect
			}
		}
		country_event = {
			id = cg_plus_enclave_slaver.9240
			days=60
		}
	}

	option =  { 
		name=cg_plus_enclave_slaver.9250.name.o
		
		allow = {
			OR={
			is_megacorp  = yes
			is_criminal_syndicate =yes
				NOT={is_species = event_target:cg_plus_slaver_captured_ruler.species }
			
			}
		}
		country_event = {
			id = cg_plus_enclave_slaver.9250
			days=60
		}
	}








	after={
		hidden_effect = {
			
			set_leader = event_target:cg_plus_slaver_captured_ruler


			country_event = {
				id = cg_plus_enclave_slaver.9901
				days = 3
			}
			country_event = {
				id = cg_plus_enclave_slaver.9102
				days = 5
			}
		}
	}
	
}

country_event={
	id = cg_plus_enclave_slaver.9102
	hide_window = yes
	is_triggered_only = yes
	immediate={
		event_target:cg_plus_slaver_captured_ruler={ unassign_leader = this }
	
		set_leader = event_target:original_ruler         

	}

	after = {
		clear_global_event_target = original_ruler
	}


}




# 9050 auction menu
country_event = {
	id = cg_plus_enclave_slaver.9050
	hide_window = no
	title= cg_plus_enclave_slaver.9050.name
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "cg_plus_acution"
	custom_gui_option = "index_button_close"
	trigger = {
		has_global_flag = cg_auction_started
		exists = event_target:cg_plus_slaver_captured_ruler
	}
	desc= ""

	picture_event_data = {
		portrait = event_target:cg_plus_slaver_captured_ruler
		room = prison_01_room
	}


	immediate = {
		set_variable = {
			which = temp_bid_price
			value = event_target:cg_plus_slaver_country.highest_bid_price
		}

		change_variable = {
			which = temp_bid_price
			value = 1000
		}



	}

	option={
		name=""
	}

}


#92xx #from 9101
#ruler after events
#

country_event = {
	id = cg_plus_enclave_slaver.9210

	title = cg_plus_enclave_slaver.9210.name
	desc = cg_plus_enclave_slaver.9210.desc
	is_triggered_only = yes
	trigger = { exists = event_target:cg_plus_slaver_captured_ruler      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave_p"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=9210  }
	}
	option = {
		name = OK
		country_event = {
			id = cg_plus_enclave_slaver.9211
			days=60
		}
	}
}
country_event = {
	id = cg_plus_enclave_slaver.9211
	
	title = cg_plus_enclave_slaver.9210.name
	desc = cg_plus_enclave_slaver.9211.desc
	is_triggered_only = yes
	trigger = { exists = event_target:cg_plus_slaver_captured_ruler      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave_p"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=9211  }
	}
	option = {
		name = cg_plus_enclave_slaver.9211.a
		add_modifier = {
			modifier = cg_plus_slaver_9210
		}
	}
}
country_event = {
	id = cg_plus_enclave_slaver.9220

	title = cg_plus_enclave_slaver.9220.name
	desc = cg_plus_enclave_slaver.9220.desc
	is_triggered_only = yes
	trigger = { exists = event_target:cg_plus_slaver_captured_ruler      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave_p"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=9220  }
	}
	option = {
		name = g_plus_enclave_slaver.9220.o
		add_modifier = {
			modifier = cg_plus_slaver_9220
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.9230
	#training_obidence_training
	title = cg_plus_enclave_slaver.9230.name
	desc = cg_plus_enclave_slaver.9230.desc
	is_triggered_only = yes
	trigger = { exists = event_target:cg_plus_slaver_captured_ruler      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=9230  }
	}
	option = {
		name = g_plus_enclave_slaver.9230.o
		add_modifier = {
			modifier = cg_plus_slaver_9230
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.9240
	#training_obidence_training
	title = cg_plus_enclave_slaver.9240.name
	desc = cg_plus_enclave_slaver.9240.desc
	is_triggered_only = yes
	trigger = { exists = event_target:cg_plus_slaver_captured_ruler      }
	diplomatic = yes
	custom_gui = "cg_plus_evt_menu_enclave_p"
	custom_gui_option = "cg_plus_evt_menu_button_e"
	#TODO
	immediate={
		set_variable =  { which=cg_plus_enclave_evt_pic  value=9240  }
	}
	option = {
		name = g_plus_enclave_slaver.9240.o
		add_modifier = {
			modifier = cg_plus_slaver_9240
		}
	}
}

country_event = {
	id = cg_plus_enclave_slaver.9250
	#training_obidence_training
	title = cg_plus_enclave_slaver.9250.name
	desc = cg_plus_enclave_slaver.9250.desc
	is_triggered_only = yes
	trigger = { exists = event_target:cg_plus_slaver_captured_ruler      }
	picture = GFX_sagiri_scared
	#TODO
	immediate={
		
	}
	option = {
		name = g_plus_enclave_slaver.9250.o
		add_resource = {
			energy = 1.5
			mult = temp_bid_price
		}
	}
}

